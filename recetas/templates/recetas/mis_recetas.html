{% extends 'recetas/base.html' %}
{% load static %}

{% block content %}
<div class="container py-5">
    <h2 class="text-center section-title mb-4">Mis recetas</h2>

    {% if recetas %}
    <div class="row row-cols-1 row-cols-md-3 g-4 animate-fadeInUp">
        {% for receta in recetas %}
        <div class="col">
            <div class="card h-100 receta-card">

                <!-- Imagen + Etiquetas -->
                <div class="position-relative">
                    {% if receta.imagen %}
                    <img src="{{ receta.imagen.url }}" class="card-img-top" alt="Imagen de {{ receta.titulo }}"
                        style="height:200px; object-fit:cover;">
                    {% endif %}

                    <div class="position-absolute top-0 start-0 m-2 d-flex flex-wrap gap-1">
                        {% for cat in receta.categorias_list %}
                        <span class="badge bg-dark text-light small">{{ cat }}</span>
                        {% endfor %}
                        {% for al in receta.alergias_list %}
                        <span class="badge bg-danger small">{{ al }}</span>
                        {% endfor %}
                    </div>
                </div>

                <!-- Cuerpo -->
                <div class="card-body">
                    <h5 class="card-title fw-bold text-dark">{{ receta.titulo }}</h5>
                    <p class="text-muted small mb-2">
                        <i class="bi bi-clock"></i> {{ receta.tiempo }} min
                        &nbsp; | &nbsp;
                        <i class="bi bi-people"></i> {{ receta.porciones }}
                    </p>
                    <p class="card-text text-dark">{{ receta.descripcion|truncatechars:90 }}</p>
                </div>

                <!-- Footer -->
                <div class="card-footer bg-transparent border-0 d-flex justify-content-between align-items-center">
                    <!-- Likes + Calificaci√≥n -->
                    <div class="d-flex align-items-center gap-3">
                        <small class="text-muted"><i class="bi bi-heart-fill text-danger"></i> 12</small>
                        <small class="text-muted"><i class="bi bi-star-fill text-warning"></i> 4.2</small>
                    </div>

                    <!-- Acciones -->
                    <div class="d-flex align-items-center gap-2">
                        <a href="{% url 'editar_receta' receta.id %}" class="btn btn-sm btn-edit" title="Editar">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <a href="{% url 'eliminar_receta' receta.id %}" class="btn btn-sm btn-delete" title="Eliminar">
                            <i class="bi bi-trash"></i>
                        </a>
                        <a href="{% url 'detalle_receta' receta.id %}" class="btn btn-gold px-4 py-2 fw-bold">
                            Ver receta
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="no-recetas-container">
        <p class="text-center text-gold fw-bold py-5">
            A√∫n no has creado ninguna receta. ¬°An√≠mate a ser el primero! üç≥
        </p>
    </div>
    {% endif %}
</div>
{% endblock %}
